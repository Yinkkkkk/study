<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>ğŸ¯ ä¸Šç˜¾å¼å­¦ä¹  Â· ç§¯åˆ†ç³»ç»Ÿ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }
        body {
            background: #f5f7fa;
            margin: 0;
            padding: 16px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }
        /* ç§¯åˆ†çœ‹æ¿ */
        .scoreboard {
            background: linear-gradient(145deg, #2c3e50, #1e2b37);
            color: white;
            padding: 24px 20px;
            border-radius: 32px;
            text-align: center;
            margin-bottom: 24px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .scoreboard h2 {
            margin: 0;
            font-size: 1.3rem;
            font-weight: 400;
            letter-spacing: 1px;
            opacity: 0.9;
        }
        .scoreboard .points {
            font-size: 4rem;
            font-weight: 700;
            line-height: 1.2;
            margin: 8px 0 4px;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        /* é€šç”¨å¡ç‰‡ */
        .card {
            background: white;
            border-radius: 28px;
            padding: 20px 18px;
            margin-bottom: 24px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.03);
        }
        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-left: 6px solid #ffb347;
            padding-left: 16px;
        }
        /* ä»»åŠ¡/å•†åŸåˆ—è¡¨ */
        .list-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .list-item {
            background: #f8f9fc;
            border-radius: 20px;
            padding: 14px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e9ecf0;
            transition: all 0.1s ease;
        }
        .list-item:active {
            background: #e9ecf0;
            transform: scale(0.99);
        }
        .item-info {
            display: flex;
            flex-direction: column;
        }
        .item-name {
            font-size: 1.2rem;
            font-weight: 500;
        }
        .item-points {
            font-size: 1rem;
            color: #f39c12;
            font-weight: 600;
            margin-top: 4px;
        }
        .button {
            background: #2c3e50;
            border: none;
            color: white;
            font-size: 1.1rem;
            font-weight: 500;
            padding: 12px 22px;
            border-radius: 40px;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 100px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .button.primary {
            background: #e67e22;
        }
        .button.secondary {
            background: #3498db;
        }
        .button:disabled {
            opacity: 0.4;
            transform: none;
            pointer-events: none;
        }
        /* è½¬ç›˜åŒºåŸŸ */
        .wheel-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
            margin-top: 10px;
        }
        .wheel-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 16px;
            width: 100%;
        }
        .wheel-result {
            background: #ecf0f1;
            border-radius: 50px;
            padding: 14px 24px;
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            width: fit-content;
            margin: 0 auto;
            border: 2px dashed #b0bec5;
        }
        .cost-badge {
            background: rgba(255,255,255,0.25);
            border-radius: 30px;
            padding: 4px 10px;
            font-size: 0.9rem;
            margin-left: 8px;
        }
        .footer-note {
            text-align: center;
            color: #7f8c8d;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        hr {
            border: none;
            border-top: 2px solid #e0e6ed;
            margin: 12px 0;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- ç§¯åˆ†æ€»è§ˆ -->
    <div class="scoreboard">
        <h2>ğŸ’° å½“å‰ç§¯åˆ†</h2>
        <div class="points" id="pointsDisplay">0</div>
        <div style="opacity:0.7; font-size:1rem;">å¤šåŠ³å¤šå¾— Â· å¿«ä¹å­¦ä¹ </div>
    </div>

    <!-- ä»»åŠ¡åˆ—è¡¨å¡ç‰‡ -->
    <div class="card">
        <div class="card-title">ğŸ“‹ é‡å¤ä»»åŠ¡</div>
        <div class="list-grid" id="taskList"></div>
        <hr>
        <div style="color:#5d6d7e; padding:8px 0 0; font-size:0.95rem;">
            âš¡ ç‚¹å‡»ã€å®Œæˆã€‘ç«‹åˆ»è·å¾—ç§¯åˆ†ï¼Œå¯åå¤å®Œæˆã€‚
        </div>
    </div>

    <!-- å•†åŸå¡ç‰‡ -->
    <div class="card">
        <div class="card-title">ğŸª ç§¯åˆ†å•†åŸ</div>
        <div class="list-grid" id="shopList"></div>
        <hr>
        <div style="color:#5d6d7e; padding:8px 0 0; font-size:0.95rem;">
            âœ¨ å…‘æ¢åç§¯åˆ†ç›¸åº”å‡å°‘ï¼Œæ‰€æœ‰ç‰©å“ä¸é™æ¬¡æ•°ã€‚
        </div>
    </div>

    <!-- è½¬ç›˜å¡ç‰‡ -->
    <div class="card">
        <div class="card-title">ğŸ² å¹¸è¿å¤§è½¬ç›˜</div>
        <div class="wheel-area">
            <div class="wheel-buttons">
                <button class="button secondary" id="freeSpinBtn">ğŸ†“ å…è´¹è½¬åŠ¨ (æ¯æ—¥ä¸€æ¬¡)</button>
                <button class="button primary" id="paidSpinBtn">ğŸ’° ä»˜è´¹è½¬åŠ¨ (20ç§¯åˆ†)</button>
            </div>
            <div class="wheel-result" id="spinResult">âœ¨ ç‚¹å‡»è½¬ç›˜è¯•è¯•æ‰‹æ°”</div>
            <div style="font-size:0.9rem; color:#2c3e50; background:#fdebd0; padding:10px 18px; border-radius:30px;">
                ğŸ å¥–é¡¹ï¼š<span id="prizeList">5, 10, 20, 50, 0 (è°¢è°¢å‚ä¸)</span>
            </div>
        </div>
    </div>
    <div class="footer-note">
        â­ æ‰€æœ‰æ•°æ®è‡ªåŠ¨ä¿å­˜åœ¨ä½ çš„iPadä¸Š Â· æ¯æ—¥5ç‚¹é‡ç½®å…è´¹è½¬ç›˜
    </div>
</div>

<script>
    (function() {
        // ---------- æ•°æ®å®šä¹‰ ----------
        // ä»»åŠ¡åˆ—è¡¨ï¼ˆå¯é‡å¤ï¼‰
        const TASKS = [
            { name: 'ğŸ“– è‹±è¯­ 25min', points: 10 },
            { name: 'ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™è¯­ 25min', points: 10 },
            { name: 'ğŸ‡®ğŸ‡¹ æ„å¤§åˆ©è¯­ 25min', points: 10 },
            { name: 'ğŸ’» ç¼–ç¨‹ 25min', points: 15 },
            { name: 'ğŸ§  å¿ƒç†å­¦ 25min', points: 10 },
            { name: 'ğŸ¬ çœ‹å¤–è¯­ç”µå½± (åŸå£°)', points: 20 }
        ];

        // å•†åŸç‰©å“ï¼ˆæ— é™æ¬¡å…‘æ¢ï¼‰
        const SHOP_ITEMS = [
            { name: 'ğŸ§‹ å¥¶èŒ¶/æœèŒ¶', pointsCost: 30 },
            { name: 'ğŸ® 1å°æ—¶æ¸¸æˆæ—¶é—´', pointsCost: 40 },
            { name: 'ğŸ“– å°è¯´ç« èŠ‚/æœ‰å£°ä¹¦', pointsCost: 15 },
            { name: 'ğŸ¿ ç»¼è‰ºåˆ‡ç‰‡ 20min', pointsCost: 25 },
            { name: 'ğŸ• å¼‚å›½æ–™ç†åŸºé‡‘', pointsCost: 60 },
            { name: 'ğŸ’¤ å…åšå¡ (ä¸€æ¬¡)', pointsCost: 50 }
        ];

        // è½¬ç›˜å¥–é¡¹ (ç§¯åˆ†å€¼)
        const SPIN_PRIZES = [5, 10, 20, 50, 0, 10, 5, 15];  // å¯é‡å¤ï¼Œæ§åˆ¶æ¦‚ç‡

        // ä»˜è´¹è½¬ç›˜æ‰€éœ€ç§¯åˆ†
        const SPIN_COST = 20;

        // ---------- çŠ¶æ€ & å­˜å‚¨ ----------
        let totalPoints = 100; // é»˜è®¤èµ·å§‹ç§¯åˆ†100ï¼Œè®©æ–°æ‰‹èƒ½ç©èµ·æ¥
        let lastFreeSpinDate = ''; // æ ¼å¼ YYYY-MM-DD

        // åŠ è½½æœ¬åœ°å­˜å‚¨
        function loadData() {
            try {
                const savedPoints = localStorage.getItem('totalPoints');
                if (savedPoints !== null) totalPoints = parseInt(savedPoints, 10) || 0;

                const savedDate = localStorage.getItem('lastFreeSpinDate');
                if (savedDate) lastFreeSpinDate = savedDate;
            } catch (e) {
                console.warn('è¯»å–å­˜å‚¨å¤±è´¥', e);
            }
        }

        // ä¿å­˜ç§¯åˆ†
        function savePoints() {
            try {
                localStorage.setItem('totalPoints', totalPoints);
            } catch (e) {}
        }

        // ä¿å­˜è½¬ç›˜æ—¥æœŸ
        function saveSpinDate(dateStr) {
            try {
                localStorage.setItem('lastFreeSpinDate', dateStr);
                lastFreeSpinDate = dateStr;
            } catch (e) {}
        }

        // è·å–ä»Šæ—¥æ—¥æœŸå­—ç¬¦ä¸² (YYYY-MM-DD)
        function getTodayString() {
            const d = new Date();
            const year = d.getFullYear();
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²ç»å…è´¹è½¬è¿‡
        function isFreeSpinAvailable() {
            return lastFreeSpinDate !== getTodayString();
        }

        // ---------- UI æ›´æ–°å‡½æ•° ----------
        const pointsDisplay = document.getElementById('pointsDisplay');
        const taskContainer = document.getElementById('taskList');
        const shopContainer = document.getElementById('shopList');
        const spinResultDiv = document.getElementById('spinResult');
        const freeSpinBtn = document.getElementById('freeSpinBtn');
        const paidSpinBtn = document.getElementById('paidSpinBtn');

        function updatePointsUI() {
            pointsDisplay.innerText = totalPoints;
            savePoints();
        }

        // æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
        function renderTasks() {
            taskContainer.innerHTML = '';
            TASKS.forEach(task => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <div class="item-info">
                        <span class="item-name">${task.name}</span>
                        <span class="item-points">+${task.points} ç§¯åˆ†</span>
                    </div>
                    <button class="button task-btn" data-points="${task.points}">âœ… å®Œæˆ</button>
                `;
                taskContainer.appendChild(item);
            });

            // ä¸ºæ‰€æœ‰ä»»åŠ¡æŒ‰é’®ç»‘å®šäº‹ä»¶
            document.querySelectorAll('.task-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const points = parseInt(btn.dataset.points, 10);
                    totalPoints += points;
                    updatePointsUI();
                    // é—ªä¸€ä¸‹æç¤º
                    btn.style.background = '#27ae60';
                    setTimeout(() => btn.style.background = '', 150);
                });
            });
        }

        // æ¸²æŸ“å•†åŸ
        function renderShop() {
            shopContainer.innerHTML = '';
            SHOP_ITEMS.forEach(item => {
                const div = document.createElement('div');
                div.className = 'list-item';
                div.innerHTML = `
                    <div class="item-info">
                        <span class="item-name">${item.name}</span>
                        <span class="item-points">ğŸ”» ${item.pointsCost} ç§¯åˆ†</span>
                    </div>
                    <button class="button primary shop-btn" data-cost="${item.pointsCost}">ğŸ å…‘æ¢</button>
                `;
                shopContainer.appendChild(div);
            });

            document.querySelectorAll('.shop-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const cost = parseInt(btn.dataset.cost, 10);
                    if (totalPoints >= cost) {
                        totalPoints -= cost;
                        updatePointsUI();
                        alert(`âœ¨ æˆåŠŸå…‘æ¢ï¼š${btn.parentElement.querySelector('.item-name').innerText}`);
                    } else {
                        alert('âŒ ç§¯åˆ†ä¸è¶³ï¼Œå¿«å»å®Œæˆä»»åŠ¡å§ï¼');
                    }
                });
            });
        }

        // æ›´æ–°è½¬ç›˜æŒ‰é’®çŠ¶æ€
        function updateSpinButtons() {
            if (isFreeSpinAvailable()) {
                freeSpinBtn.disabled = false;
                freeSpinBtn.innerText = 'ğŸ†“ å…è´¹è½¬åŠ¨ (ä»Šæ—¥å¯ç”¨)';
            } else {
                freeSpinBtn.disabled = true;
                freeSpinBtn.innerText = 'ğŸ†“ å…è´¹è½¬åŠ¨ (ä»Šæ—¥å·²ç”¨)';
            }
            // ä»˜è´¹æŒ‰é’®åªè¦ç§¯åˆ†è¶³å¤Ÿå°±å¯ç”¨ï¼Œä½†åŠ¨æ€æ ·å¼ä¹Ÿå¯ä»¥
            if (totalPoints < SPIN_COST) {
                paidSpinBtn.disabled = true;
                paidSpinBtn.innerText = `ğŸ’° ä»˜è´¹è½¬åŠ¨ (éœ€${SPIN_COST}ç§¯åˆ†)`;
            } else {
                paidSpinBtn.disabled = false;
                paidSpinBtn.innerText = `ğŸ’° ä»˜è´¹è½¬åŠ¨ (${SPIN_COST}ç§¯åˆ†)`;
            }
        }

        // è½¬åŠ¨è½¬ç›˜ (isFree: æ˜¯å¦å…è´¹)
        function spinWheel(isFree) {
            if (isFree) {
                if (!isFreeSpinAvailable()) {
                    alert('ä»Šå¤©å·²ç»å…è´¹è½¬åŠ¨è¿‡å•¦ï¼Œæ˜å¤©å†æ¥ï¼');
                    return false;
                }
                // è®°å½•ä»Šå¤©å·²ç”¨
                saveSpinDate(getTodayString());
            } else {
                // ä»˜è´¹
                if (totalPoints < SPIN_COST) {
                    alert('ç§¯åˆ†ä¸è¶³ï¼');
                    return false;
                }
                totalPoints -= SPIN_COST;
                updatePointsUI();
            }

            // éšæœºæŠ½å–å¥–åŠ±
            const randomIndex = Math.floor(Math.random() * SPIN_PRIZES.length);
            const prize = SPIN_PRIZES[randomIndex];
            totalPoints += prize;
            updatePointsUI();

            // æ˜¾ç¤ºç»“æœ
            let prizeText = prize === 0 ? 'è°¢è°¢å‚ä¸ +0' : `+${prize} ç§¯åˆ†`;
            spinResultDiv.innerText = `ğŸ‰ æŠ½ä¸­ï¼š${prizeText}`;

            // æ’­æ”¾ç®€å•åŠ¨ç”»
            spinResultDiv.style.transform = 'scale(1.05)';
            setTimeout(() => spinResultDiv.style.transform = '', 200);

            // æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼ˆå…è´¹æŒ‰é’®å¯èƒ½å˜ç¦ç”¨ï¼‰
            updateSpinButtons();
            return true;
        }

        // åˆå§‹åŒ–
        function init() {
            loadData();
            // å¦‚æœç§¯åˆ†NaNï¼Œé‡ç½®ä¸º100
            if (isNaN(totalPoints) || totalPoints < 0) totalPoints = 100;
            updatePointsUI();
            renderTasks();
            renderShop();
            updateSpinButtons();

            // ç»‘å®šè½¬ç›˜äº‹ä»¶
            freeSpinBtn.addEventListener('click', () => spinWheel(true));
            paidSpinBtn.addEventListener('click', () => spinWheel(false));

            // å¯é€‰é¡¹ï¼šæ˜¾ç¤ºå¥–é¡¹åˆ—è¡¨
            const uniquePrizes = [...new Set(SPIN_PRIZES)].sort((a,b)=>a-b);
            document.getElementById('prizeList').innerText = uniquePrizes.join(', ') + (uniquePrizes.includes(0)?' (0=è°¢è°¢å‚ä¸)':'');
        }

        init();
    })();
</script>
</body>
</html>